### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∫—Ä–∏–ø—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
db_manage/
‚îú‚îÄ‚îÄ create-schema-manual.sh
‚îú‚îÄ‚îÄ delete-schema.sh
‚îú‚îÄ‚îÄ test-schema-permissions.sh
‚îî‚îÄ‚îÄ postgres-schema-script-instruction.md
```

---

#### –û–ø–∏—Å–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

–ù–∞–±–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å PostgreSQL —Å—Ö–µ–º–∞–º–∏ –≤ Selectel Managed Databases:

##### `create-schema-manual.sh`
–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã, –≤—ã–¥–∞—á–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –¥–ª—è Kubernetes Secret

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞—ë—Ç —Å—Ö–µ–º—É –≤ PostgreSQL
- –í—ã–¥–∞—ë—Ç –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (—Å–æ–∑–¥–∞–Ω–Ω–æ–º—É —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Selectel)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é (–∑–∞–ø—Ä–µ—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ public –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ö–µ–º)
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç YAML –¥–ª—è Secret (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ GitLab CI/CD)

##### `delete-schema.sh`
–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã PostgreSQL

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£–¥–∞–ª—è–µ—Ç —Å—Ö–µ–º—É —Å–æ –≤—Å–µ–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ (CASCADE)
- –ù–µ —É–¥–∞–ª—è–µ—Ç Kubernetes Secret (—É–¥–∞–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- –ù–∞–ø–æ–º–∏–Ω–∞–µ—Ç —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Selectel

##### `test-schema-permissions.sh`
–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PostgreSQL

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–∑–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ (CREATE, INSERT, SELECT, UPDATE, DELETE)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é –æ—Ç –¥—Ä—É–≥–∏—Ö —Å—Ö–µ–º
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–∑–∞–ø—Ä–µ—Ç CREATE SCHEMA, CREATE USER)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º (information_schema)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ PostgreSQL —Å–æ–∑–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Selectel (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ managed databases)
- Secret –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ `kubectl apply` –∏–ª–∏ GitLab CI/CD
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ö–µ–º—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π

---

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ‚úÖ `kubectl` —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä—É
- ‚úÖ Kubernetes Secret `postgres-creds` –≤ namespace `bastion`
- ‚úÖ Deployment `bastion` –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–ø–∞–Ω–µ–ª–∏ Selectel –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `bash` –≤–µ—Ä—Å–∏–∏ 4.0+

---

#### Naming Convention

##### –°—Ö–µ–º—ã
–§–æ—Ä–º–∞—Ç: `{service_name}_{environment}`

–ü—Ä–∏–º–µ—Ä—ã:
- `auth_service_staging`
- `profile_service_prod`
- `project_service_staging`

##### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
–§–æ—Ä–º–∞—Ç: `{service_name}_{environment}_app`

–ü—Ä–∏–º–µ—Ä—ã:
- `auth_service_staging_app`
- `profile_service_prod_app`

##### Kubernetes Secrets
–§–æ—Ä–º–∞—Ç: `postgres-{service-name}-{environment}-app`

–ü—Ä–∏–º–µ—Ä—ã:
- `postgres-auth-service-staging-app`
- `postgres-profile-service-prod-app`

**–í–∞–∂–Ω–æ:** –í –Ω–∞–∑–≤–∞–Ω–∏—è—Ö Secret –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏—è –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –¥–µ—Ñ–∏—Å—ã.

---

#### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

##### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd db_manage
chmod +x create-schema-manual.sh
```

##### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
./create-schema-manual.sh <service_name> <environment>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `service_name` ‚Äî –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `auth_service`, `profile_service`)
- `environment` ‚Äî –æ–∫—Ä—É–∂–µ–Ω–∏–µ (`staging` –∏–ª–∏ `prod`)

##### –ü—Ä–∏–º–µ—Ä—ã

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –¥–ª—è auth_service –≤ staging
./create-schema-manual.sh auth_service staging

# –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã –¥–ª—è profile_service –≤ production
./create-schema-manual.sh profile_service prod
```

---

#### Workflow —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã

##### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ:

```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚Ñπ –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞: auth_service
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ:

  üóÑÔ∏è  PostgreSQL:
      –°—Ö–µ–º–∞:        auth_service_staging
      –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: auth_service_staging_app

  üîê Kubernetes:
      Secret:    postgres-auth-service-staging-app
      Namespace: postgres

–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (y/n):
```

##### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Selectel

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é:

```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö† –¢–†–ï–ë–£–ï–¢–°–Ø –†–£–ß–ù–û–ï –î–ï–ô–°–¢–í–ò–ï: –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Selectel
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

  1Ô∏è‚É£  –û—Ç–∫—Ä–æ–π—Ç–µ: my.selectel.ru ‚Üí Cloud Platform ‚Üí Managed Databases
  2Ô∏è‚É£  –í—ã–±–µ—Ä–∏—Ç–µ PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä
  3Ô∏è‚É£  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏¬ª
  4Ô∏è‚É£  –ù–∞–∂–º–∏—Ç–µ ¬´–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è¬ª
  5Ô∏è‚É£  –ò–º—è: auth_service_staging_app
  6Ô∏è‚É£  –ü–∞—Ä–æ–ª—å: [–Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å]
  7Ô∏è‚É£  –î–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ: db_main
  8Ô∏è‚É£  –ù–∞–∂–º–∏—Ç–µ ¬´–°–æ–∑–¥–∞—Ç—å¬ª

‚ö† –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–∂–º–∏—Ç–µ Enter...
```

##### –®–∞–≥ 3: –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è

```
‚Ñπ –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è auth_service_staging_app:

–ü–∞—Ä–æ–ª—å: ********
```

##### –®–∞–≥ 4: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –¥–ª—è Secret

```
‚ñ∂ –®–∞–≥ 5/5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –¥–ª—è Kubernetes Secret...

‚Ñπ –°–∫–æ–ø–∏—Ä—É–π—Ç–µ YAML –Ω–∏–∂–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ GitLab CI/CD:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

apiVersion: v1
kind: Secret
metadata:
  name: postgres-auth-service-staging-app
  namespace: postgres
type: Opaque
data:
  host: bWFzdGVyLmU5MzQy...
  port: NTQzMg==
  dbname: ZGJfbWFpbg==
  user: YXV0aF9zZXJ2aWNl...
  password: RUdYSnV2aHhFcTRF
  schema: YXV0aF9zZXJ2aWNl...
```

##### –®–∞–≥ 5: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ Secret

###### –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä—É—á–Ω—É—é

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ YAML –∏–∑ –≤—ã–≤–æ–¥–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª
cat > secret.yaml <<EOF
apiVersion: v1
kind: Secret
...
EOF

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ Secret
kubectl apply -f secret.yaml

# –£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
rm secret.yaml
```

###### –í–∞—Ä–∏–∞–Ω—Ç 2: GitLab CI/CD

–î–æ–±–∞–≤—å—Ç–µ YAML –≤ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```yaml
# k8s/secrets/postgres-auth-service-staging-app.yaml
apiVersion: v1
kind: Secret
metadata:
  name: postgres-auth-service-staging-app
  namespace: postgres
type: Opaque
data:
  host: bWFzdGVyLmU5MzQy...
  ...
```

##### –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìã –†–µ–∑—É–ª—å—Ç–∞—Ç:

  üóÑÔ∏è  PostgreSQL:
     –°—Ö–µ–º–∞:        auth_service_staging (—Å–æ–∑–¥–∞–Ω–∞)
     –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: auth_service_staging_app (—Å–æ–∑–¥–∞–Ω)
     –ü—Ä–∞–≤–∞:        ‚úÖ CREATE –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Å–≤–æ–µ–π —Å—Ö–µ–º–µ
                   ‚ùå CREATE –Ω–æ–≤—ã—Ö —Å—Ö–µ–º –∑–∞–ø—Ä–µ—â—ë–Ω
                   ‚ùå –î–æ—Å—Ç—É–ø –∫ —Å—Ö–µ–º–µ public –∑–∞–ø—Ä–µ—â—ë–Ω

  üîê Kubernetes Secret:
     –ù–∞–∑–≤–∞–Ω–∏–µ:  postgres-auth-service-staging-app
     Namespace: postgres

  ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏ –≤ Secret:
     ‚Ä¢ host
     ‚Ä¢ port
     ‚Ä¢ dbname
     ‚Ä¢ user
     ‚Ä¢ password
     ‚Ä¢ schema
```

---

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:

```bash
./test-schema-permissions.sh auth_service staging
```

##### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

  –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 17
  –ü—Ä–æ–π–¥–µ–Ω–æ:     17
  –ü—Ä–æ–≤–∞–ª–µ–Ω–æ:    0

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´! ‚ú®
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:
  ‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–µ–π —Å—Ö–µ–º–µ
  ‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º —Å—Ö–µ–º–∞–º
  ‚Ä¢ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ö–µ–º—ã/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  ‚Ä¢ –ü—Ä–∞–≤–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø—É least privilege
```

---

#### –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã

##### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
./delete-schema.sh <service_name> <environment>
```

##### –ü—Ä–∏–º–µ—Ä—ã

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã auth_service –≤ staging
./delete-schema.sh auth_service staging
```

##### Workflow —É–¥–∞–ª–µ–Ω–∏—è

###### –®–∞–≥ 1: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö† –£–î–ê–õ–ï–ù–ò–ï –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞: auth_service
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚ö†Ô∏è  –ë—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ:

  üóÑÔ∏è  PostgreSQL:
      –°—Ö–µ–º–∞: auth_service_staging (–≤–∫–ª—é—á–∞—è –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã)

  üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL:
      auth_service_staging_app (—Ç—Ä–µ–±—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Selectel)

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚ö† –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –ù–ï–û–ë–†–ê–¢–ò–ú–û! –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ —Å—Ö–µ–º–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.

–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–≤–µ–¥–∏—Ç–µ 'yes' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
```

###### –®–∞–≥ 2: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã

```
‚Ñπ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã 'auth_service_staging'...
‚úÖ –°—Ö–µ–º–∞ 'auth_service_staging' —É–¥–∞–ª–µ–Ω–∞
```

###### –®–∞–≥ 3: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Secret

```
‚Ñπ –ü—Ä–æ–≤–µ—Ä–∫–∞ Kubernetes Secret...
‚ö† Secret 'postgres-auth-service-staging-app' –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

  üìù –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å Secret –≤—Ä—É—á–Ω—É—é:
     kubectl delete secret postgres-auth-service-staging-app -n postgres
```

###### –®–∞–≥ 4: –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Selectel

```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ö† –¢–†–ï–ë–£–ï–¢–°–Ø –†–£–ß–ù–û–ï –î–ï–ô–°–¢–í–ò–ï: –£–¥–∞–ª–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Selectel
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: auth_service_staging_app

  1Ô∏è‚É£  –û—Ç–∫—Ä–æ–π—Ç–µ: my.selectel.ru ‚Üí Cloud Platform ‚Üí Managed Databases
  2Ô∏è‚É£  –í—ã–±–µ—Ä–∏—Ç–µ PostgreSQL –∫–ª–∞—Å—Ç–µ—Ä
  3Ô∏è‚É£  –í–∫–ª–∞–¥–∫–∞ ¬´–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏¬ª
  4Ô∏è‚É£  –ù–∞–π–¥–∏—Ç–µ: auth_service_staging_app
  5Ô∏è‚É£  –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è (–∫–æ—Ä–∑–∏–Ω–∞)
  6Ô∏è‚É£  –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ

‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!
```

---

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Secret –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

##### –ü—Ä–∏–º–µ—Ä Deployment

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: auth-service
  namespace: auth-service
spec:
  template:
    spec:
      containers:
      - name: app
        image: your-registry/auth-service:latest
        env:
        - name: DB_HOST
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: host
        - name: DB_PORT
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: port
        - name: DB_NAME
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: dbname
        - name: DB_USER
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: user
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: password
        - name: DB_SCHEMA
          valueFrom:
            secretKeyRef:
              name: postgres-auth-service-staging-app
              key: schema
```

---

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é

##### –ß–µ—Ä–µ–∑ bastion pod

```bash
kubectl exec -it deployment/bastion -n bastion -- bash

# –≠–∫—Å–ø–æ—Ä—Ç –ø–∞—Ä–æ–ª—è
export PGPASSWORD='your_password'

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
psql -h master.e9342be5-6813-4af4-aa03-5136361f9980.c.dbaas.selcloud.ru      -U auth_service_staging_app      -d db_main

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ search_path
SET search_path TO 'auth_service_staging';

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º—ã
SELECT current_schema();

# –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
CREATE TABLE test_table (id SERIAL PRIMARY KEY, name VARCHAR(50));
INSERT INTO test_table (name) VALUES ('test');
SELECT * FROM test_table;
DROP TABLE test_table;
```

---

#### –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–µ—Ç–∞–ª–∏)

##### –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

‚úÖ **–í —Å–≤–æ–µ–π —Å—Ö–µ–º–µ:**
- CREATE TABLE, INDEX, SEQUENCE, FUNCTION
- INSERT, SELECT, UPDATE, DELETE
- DROP —Å–≤–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- ALTER —Å–≤–æ–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

‚úÖ **–°–∏—Å—Ç–µ–º–Ω—ã–µ:**
- –ß—Ç–µ–Ω–∏–µ information_schema
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ db_main

##### –ß—Ç–æ –ù–ï –º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

‚ùå **–ó–∞–ø—Ä–µ—â–µ–Ω–æ:**
- CREATE SCHEMA (—Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ö–µ–º)
- CREATE USER / ROLE (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –î–æ—Å—Ç—É–ø –∫ –¥—Ä—É–≥–∏–º —Å—Ö–µ–º–∞–º (–∫—Ä–æ–º–µ —Å–≤–æ–µ–π)
- –î–æ—Å—Ç—É–ø –∫ —Å—Ö–µ–º–µ public
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

#### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

##### –°–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º

```bash
kubectl exec -it deployment/bastion -n bastion -- psql -c "\dn"
```

##### –°–ø–∏—Å–æ–∫ Kubernetes Secrets

```bash
kubectl get secrets -n postgres | grep postgres-
```

##### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ Secret

```bash
kubectl get secret postgres-auth-service-staging-app -n postgres -o yaml
```

---

#### Troubleshooting

##### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ Selectel
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–µ `db_main`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Secret: `kubectl get secret ... -o yaml`

##### –ü—Ä–æ–±–ª–µ–º–∞: –¢–µ—Å—Ç—ã –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å –≤—ã–≤–æ–¥–æ–º –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞: `\du –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å—Ö–µ–º—É —Å –≤—ã–¥–∞—á–µ–π –ø—Ä–∞–≤

##### –ü—Ä–æ–±–ª–µ–º–∞: Secret –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ YAML –Ω–∞ –æ—à–∏–±–∫–∏
kubectl apply -f secret.yaml --dry-run=client

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ namespace
kubectl get ns postgres

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Å –≤—ã–≤–æ–¥–æ–º –æ—à–∏–±–æ–∫
kubectl apply -f secret.yaml -v=8
```

---

#### Best Practices

1. **–í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç—ã** –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã
2. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏** –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (Vault, 1Password)
3. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ Secret YAML** –≤ –ø—É–±–ª–∏—á–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ staging** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ prod
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ —Å—Ö–µ–º–∞—Ö
